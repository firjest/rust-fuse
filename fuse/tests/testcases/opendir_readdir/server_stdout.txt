START /rust-fuse/test_server

LookupRequest {
    parent_id: 1,
    name: "readdir.d",
}
LookupResponse {
    node: Node {
        id: Some(2),
        generation: 0,
        cache_timeout: 60s,
        attr_cache_timeout: 0ns,
        attr: NodeAttr {
            node_id: None,
            size: 0,
            blocks: 0,
            atime: 0ns,
            mtime: 0ns,
            ctime: 0ns,
            mode: 0o40755,
            nlink: 2,
            uid: 0,
            gid: 0,
            rdev: 0,
            blksize: 0,
        },
    },
}

OpendirRequest {
    node_id: 2,
    flags: 0x00018000,
}
OpendirResponse {
    handle: 12345,
    flags: OpendirResponseFlags {
        keep_cache: false,
        nonseekable: false,
    },
}

ReaddirRequest {
    node_id: 2,
    size: 4096,
    cursor: None,
    handle: 12345,
    opendir_flags: 0x00018000,
}
ReaddirResponse {
    entries: [
        ReaddirEntry {
            node_id: 10,
            cursor: 1,
            file_type: Regular,
            name: "entry_a",
        },
        ReaddirEntry {
            node_id: 11,
            cursor: 2,
            file_type: Symlink,
            name: "entry_b",
        },
    ],
}

ReaddirRequest {
    node_id: 2,
    size: 4096,
    cursor: Some(1),
    handle: 12345,
    opendir_flags: 0x00018000,
}
ReaddirResponse {
    entries: [
        ReaddirEntry {
            node_id: 11,
            cursor: 2,
            file_type: Symlink,
            name: "entry_b",
        },
    ],
}

ReaddirRequest {
    node_id: 2,
    size: 4096,
    cursor: Some(2),
    handle: 12345,
    opendir_flags: 0x00018000,
}
ReaddirResponse {
    entries: [
        ReaddirEntry {
            node_id: 12,
            cursor: 3,
            file_type: Directory,
            name: "entry_c",
        },
    ],
}

ReleasedirRequest {
    node_id: 2,
    handle: 12345,
    lock_owner: None,
    opendir_flags: 0x00018000,
}
ReleasedirResponse
